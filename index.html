<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Sinalizador SSE</title>
</head>
<body>
  <script>
    const eventSource = new EventSource(
      "https://ffbrunoff.app.n8n.cloud/webhook/sse-imagem"
    );

    eventSource.addEventListener("imagem_atualizada", (event) => {
      parent.postMessage({ tipo: "imagem_atualizada" }, "*");
      eventSource.close();          // ← NOVO  (impede reconexões)
    });

    eventSource.onerror = (e) => {
      console.error("Erro na conexão SSE:", e);
      eventSource.close();          // ← NOVO  (fecha em caso de erro)
    };
  </script>

  <p style="font-family: sans-serif;">Sinalizador ativo...</p>
</body>
</html>
